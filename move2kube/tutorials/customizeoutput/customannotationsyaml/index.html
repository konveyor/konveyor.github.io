<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.120.4"><meta name=description content><link rel=icon href=/images/favicon.png type=image/png><title>Add custom annotations to Kubernetes YAMLs - Documentation for Konveyor projects</title>
<link href=/css/nucleus.css rel=stylesheet><link href=/css/fontawesome-all.min.css rel=stylesheet><link href=/css/hybrid.css rel=stylesheet><link href=/css/featherlight.min.css rel=stylesheet><link href=/css/perfect-scrollbar.min.css rel=stylesheet><link href=/css/auto-complete.css rel=stylesheet><link href=/css/atom-one-dark-reasonable.css rel=stylesheet><link href=/css/theme.css rel=stylesheet><link href=/css/tabs.css rel=stylesheet><link href=/css/hugo-theme.css rel=stylesheet><link href=/css/theme-konveyor.css rel=stylesheet><link href=/css/foo.css rel=stylesheet><link href=/css/bar.css rel=stylesheet><script src=/js/jquery-3.3.1.min.js></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style><script>var dataLayer=window.dataLayer=window.dataLayer||[];dataLayer.push({page:"Add custom annotations to Kubernetes YAMLs",fileUniqID:"81258f796647beefadd18a84a722cd9e"})</script><script>(function(e,t,n,s,o){e[s]=e[s]||[],e[s].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var a=t.getElementsByTagName(n)[0],i=t.createElement(n),r=s!="dataLayer"?"&l="+s:"";i.async=!0,i.src="https://www.googletagmanager.com/gtm.js?id="+o+r,a.parentNode.insertBefore(i,a)})(window,document,"script","dataLayer","GTM-TKPDMS3")</script></head><body data-url=/move2kube/tutorials/customizeoutput/customannotationsyaml/><nav id=sidebar><div id=header-wrapper><div id=header><a id=logo href=/><img src=/images/konveyor_logo.png></img></a>
<a href=https://github.com/konveyor/konveyor.github.io>Documentation source code</a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=/js/lunr.min.js></script><script type=text/javascript src=/js/auto-complete.js></script><script type=text/javascript>var baseurl="http://konveyor.github.io/"</script><script type=text/javascript src=/js/search.js></script></div><div class=highlightable><ul class=topics><li data-nav-id=/konveyor/ title=Konveyor class=dd-item><a href=/konveyor/>Konveyor</a><ul><li data-nav-id=/konveyor/contributetokonveyor/ title="Contributing To Konveyor" class=dd-item><a href=/konveyor/contributetokonveyor/>Contributing To Konveyor</a></li><li data-nav-id=/konveyor/admintasks/ title="Administrator view tasks" class=dd-item><a href=/konveyor/admintasks/>Administrator view tasks</a></li><li data-nav-id=/konveyor/views/ title=Views class=dd-item><a href=/konveyor/views/>Views</a></li><li data-nav-id=/konveyor/instances/ title="Seeding Instances" class=dd-item><a href=/konveyor/instances/>Seeding Instances</a></li><li data-nav-id=/konveyor/installation/ title="Installing Konveyor" class=dd-item><a href=/konveyor/installation/>Installing Konveyor</a></li><li data-nav-id=/konveyor/assessanalyze/ title="Assessing and analyzing applications" class=dd-item><a href=/konveyor/assessanalyze/>Assessing and analyzing applications</a></li><li data-nav-id=/konveyor/addapps/ title="Adding applications" class=dd-item><a href=/konveyor/addapps/>Adding applications</a></li></ul></li><li data-nav-id=/move2kube/ title=Move2Kube class="dd-item
parent"><a href=/move2kube/>Move2Kube</a><ul><li data-nav-id=/move2kube/concepts/ title=Concepts class=dd-item><a href=/move2kube/concepts/>Concepts</a></li><li data-nav-id=/move2kube/installation/ title=Installation class=dd-item><a href=/move2kube/installation/>Installation</a><ul><li data-nav-id=/move2kube/installation/installweb/ title="Web Interface" class=dd-item><a href=/move2kube/installation/installweb/>Web Interface</a></li><li data-nav-id=/move2kube/installation/installcli/ title="Command line tool" class=dd-item><a href=/move2kube/installation/installcli/>Command line tool</a></li></ul></li><li data-nav-id=/move2kube/commands/ title=Commands class=dd-item><a href=/move2kube/commands/>Commands</a></li><li data-nav-id=/move2kube/transformers/ title=Transformers class=dd-item><a href=/move2kube/transformers/>Transformers</a></li><li data-nav-id=/move2kube/tutorials/ title=Tutorials class="dd-item
parent"><a href=/move2kube/tutorials/>Tutorials</a><ul><li data-nav-id=/move2kube/tutorials/usingcli/ title="Using Move2Kube CLI" class=dd-item><a href=/move2kube/tutorials/usingcli/>Using Move2Kube CLI</a></li><li data-nav-id=/move2kube/tutorials/usingui/ title="Using Move2Kube UI" class=dd-item><a href=/move2kube/tutorials/usingui/>Using Move2Kube UI</a></li><li data-nav-id=/move2kube/tutorials/cfappstok8/ title="Migrating Enterprise Scale Cloud Foundry Apps to Kubernetes" class=dd-item><a href=/move2kube/tutorials/cfappstok8/>Migrating Enterprise Scale Cloud Foundry Apps to Kubernetes</a><ul><li data-nav-id=/move2kube/tutorials/cfappstok8/1collect/ title="1. Collect" class=dd-item><a href=/move2kube/tutorials/cfappstok8/1collect/>1. Collect</a></li><li data-nav-id=/move2kube/tutorials/cfappstok8/2plan/ title="2. Plan" class=dd-item><a href=/move2kube/tutorials/cfappstok8/2plan/>2. Plan</a></li><li data-nav-id=/move2kube/tutorials/cfappstok8/3transform/ title="3. Transform" class=dd-item><a href=/move2kube/tutorials/cfappstok8/3transform/>3. Transform</a></li></ul></li><li data-nav-id=/move2kube/tutorials/customizeoutput/ title="Customizing the output" class="dd-item
parent"><a href=/move2kube/tutorials/customizeoutput/>Customizing the output</a><ul><li data-nav-id=/move2kube/tutorials/customizeoutput/addcustfiledir/ title="Add custom files and directories in custom locations" class=dd-item><a href=/move2kube/tutorials/customizeoutput/addcustfiledir/>Add custom files and directories in custom locations</a></li><li data-nav-id=/move2kube/tutorials/customizeoutput/paramcustomfieldshelm/ title="Parameterizing custom fields in Helm Chart, Kustomize, OC templates" class=dd-item><a href=/move2kube/tutorials/customizeoutput/paramcustomfieldshelm/>Parameterizing custom fields in Helm Chart, Kustomize, OC templates</a></li><li data-nav-id=/move2kube/tutorials/customizeoutput/customannotationsyaml/ title="Add custom annotations to Kubernetes YAMLs" class="dd-item active"><a href=/move2kube/tutorials/customizeoutput/customannotationsyaml/>Add custom annotations to Kubernetes YAMLs</a></li><li data-nav-id=/move2kube/tutorials/customizeoutput/customgendockerfile/ title="Customize generated Dockerfile and built-in transformer behavior" class=dd-item><a href=/move2kube/tutorials/customizeoutput/customgendockerfile/>Customize generated Dockerfile and built-in transformer behavior</a></li></ul></li><li data-nav-id=/move2kube/tutorials/customkubeyaml/ title="Customize Kubernetes YAMLs to target specific clusters" class=dd-item><a href=/move2kube/tutorials/customkubeyaml/>Customize Kubernetes YAMLs to target specific clusters</a></li><li data-nav-id=/move2kube/tutorials/createhelmchartskustomize/ title="Create Helm-charts, Kustomize overlays from Kubernetes Yamls" class=dd-item><a href=/move2kube/tutorials/createhelmchartskustomize/>Create Helm-charts, Kustomize overlays from Kubernetes Yamls</a></li><li data-nav-id=/move2kube/tutorials/createwincontainersnet/ title="Create and deploy Windows .NET containers" class=dd-item><a href=/move2kube/tutorials/createwincontainersnet/>Create and deploy Windows .NET containers</a></li><li data-nav-id=/move2kube/tutorials/migratedeploynetcore/ title="Migrate and deploy .NET Core applications to Kubernetes" class=dd-item><a href=/move2kube/tutorials/migratedeploynetcore/>Migrate and deploy .NET Core applications to Kubernetes</a></li><li data-nav-id=/move2kube/tutorials/migratedockercomposekube/ title="Migrate from Docker Compose to Kubernetes" class=dd-item><a href=/move2kube/tutorials/migratedockercomposekube/>Migrate from Docker Compose to Kubernetes</a></li><li data-nav-id=/move2kube/tutorials/migratedeploycfapps/ title="Migrate and deploy Cloud Foundry applications to Kubernetes" class=dd-item><a href=/move2kube/tutorials/migratedeploycfapps/>Migrate and deploy Cloud Foundry applications to Kubernetes</a></li><li data-nav-id=/move2kube/tutorials/runnoninteractively/ title="Run transforms non-interactively" class=dd-item><a href=/move2kube/tutorials/runnoninteractively/>Run transforms non-interactively</a></li></ul></li></ul></li></ul><section id=footer><p>Built with <a href=https://github.com/matcornic/hugo-theme-learn><i class="fas fa-heart"></i></a> from <a href=https://getgrav.org>Grav</a> and <a href=https://gohugo.io/>Hugo</a></p></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i>
</a></span><span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links>Add custom annotations to Kubernetes YAMLs</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#anatomy-of-ingress-annotator-transformer>Anatomy of ingress annotator transformer</a></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Add custom annotations to Kubernetes YAMLs</h1><p>Move2Kube generates Kubernetes YAMLs based on the needs of the application, but there might be situations that might require specific fields to be different in the output. This example illustrates how to add an annotation to the Ingress YAML specifying an ingress class.</p><ol><li>Create an empty workspace directory named <code>workspace</code> and make it the current working directory. Assume all commands are executed within this directory.</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>$ mkdir workspace <span style=color:#f92672>&amp;&amp;</span> cd workspace
</span></span></code></pre></div><ol start=2><li>Use the <a href=https://github.com/konveyor/move2kube-demos/tree/main/samples/enterprise-app>enterprise-app</a> as the input for this flow.</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>$ curl https://move2kube.konveyor.io/scripts/download.sh | bash -s -- -d samples/enterprise-app/src -r move2kube-demos
</span></span><span style=display:flex><span>$ ls src
</span></span><span style=display:flex><span>README.md		config-utils		customers	docs			frontend		gateway			orders
</span></span></code></pre></div><ol start=3><li>Run Move2Kube <strong>without</strong> any customization and the output ingress does not have any annotation. Once done, delete the <code>myproject</code> directory.</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>$ move2kube transform -s src/ --qa-skip <span style=color:#f92672>&amp;&amp;</span> cat myproject/deploy/yamls/myproject-ingress.yaml <span style=color:#f92672>&amp;&amp;</span> rm -rf myproject
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>  <span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>networking.k8s.io/v1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Ingress</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>creationTimestamp</span>: <span style=color:#66d9ef>null</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>move2kube.konveyor.io/service</span>: <span style=color:#ae81ff>myproject</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>: <span style=color:#ae81ff>myproject</span>
</span></span></code></pre></div><ol start=4><li>Get the Starlark based custom transformer <a href=https://github.com/konveyor/move2kube-transformers/tree/main/add-custom-kubernetes-annotation>here</a> and copy it into the <code>customizations</code> sub-directory.</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>$ curl https://move2kube.konveyor.io/scripts/download.sh | bash -s -- -d add-custom-kubernetes-annotation -r move2kube-transformers -o customizations
</span></span></code></pre></div><ol start=5><li>Transform using this customization and specify it using the <code>-c</code> flag.</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>$ move2kube transform -s src/ -c customizations/ --qa-skip
</span></span></code></pre></div><p>Once the output is generated, note in the snippet of the ingress file (<code>myproject/deploy/yamls/myproject-ingress.yaml</code>) that there is an annotation for the ingress class added (<code>kubernetes.io/ingress.class: haproxy</code>):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>$ cat myproject/deploy/yamls/myproject-ingress.yaml
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>  <span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>networking.k8s.io/v1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Ingress</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>annotations</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>kubernetes.io/ingress.class</span>: <span style=color:#ae81ff>haproxy</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>creationTimestamp</span>: <span style=color:#66d9ef>null</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>move2kube.konveyor.io/service</span>: <span style=color:#ae81ff>myproject</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>: <span style=color:#ae81ff>myproject</span>
</span></span></code></pre></div><h2 id=anatomy-of-ingress-annotator-transformer>Anatomy of ingress annotator transformer</h2><p>This custom transformer uses a configuration YAML (<code>ingress-annotator.yaml</code>) and a Starlark script (<code>ingress-annotator.star</code>) to add an annotation to the ingress YAML. The contents of custom transformer are shown below:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>$ ls customizations/add-custom-kubernetes-annotation
</span></span><span style=display:flex><span>ingress-annotator.star  ingress-annotator.yaml
</span></span></code></pre></div><p>The configuration YAML specifies that the custom transformer consumes and produces a Kubernetes YAML artifact type as shown in the <code>consumes</code> and <code>produces</code> section.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>$ cat customizations/add-custom-kubernetes-annotation/ingress-annotator.yaml
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>  <span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>move2kube.konveyor.io/v1alpha1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Transformer</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>: <span style=color:#ae81ff>IngressAnnotator</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>move2kube.konveyor.io/built-in</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>class</span>: <span style=color:#e6db74>&#34;Starlark&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>consumes</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>KubernetesYamls</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>merge</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># Ensures a artifact of this type gets immediately intercepted by this transformer</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>mode</span>: <span style=color:#e6db74>&#34;MandatoryPassThrough&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>produces</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>KubernetesYamls</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>disabled</span>: <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>config</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>starFile</span>: <span style=color:#e6db74>&#34;ingress-annotator.star&#34;</span>
</span></span></code></pre></div><p>The code of the Starlark script is shown below. At a high-level, the code requires only the <code>transform()</code> function as it acts upon any Kubernetes YAML generated within Move2Kube. The <code>transform()</code> function loops through every YAML generated for every detected service, checks whether it is an ingress YAML, and if so adds the annotation. The path mappings are meant to persist these changes.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>$ cat customizations/add-custom-kubernetes-annotation/ingress-annotator.star
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>  {<span style=color:#f92672>%</span> raw <span style=color:#f92672>%</span>}<span style=color:#66d9ef>def</span> <span style=color:#a6e22e>transform</span>(new_artifacts, old_artifacts):
</span></span><span style=display:flex><span>      pathMappings <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>      artifacts <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>for</span> a <span style=color:#f92672>in</span> new_artifacts:
</span></span><span style=display:flex><span>          yamlsPath <span style=color:#f92672>=</span> a[<span style=color:#e6db74>&#34;paths&#34;</span>][<span style=color:#e6db74>&#34;KubernetesYamls&#34;</span>][<span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>          serviceName <span style=color:#f92672>=</span> a[<span style=color:#e6db74>&#34;name&#34;</span>]
</span></span><span style=display:flex><span>          artifacts<span style=color:#f92672>.</span>append(a)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>          fileList <span style=color:#f92672>=</span> fs<span style=color:#f92672>.</span>readdir(yamlsPath)
</span></span><span style=display:flex><span>          yamlsBasePath <span style=color:#f92672>=</span> yamlsPath<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#34;/&#34;</span>)[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>          <span style=color:#75715e># Create a custom path template for the service, whose values gets filled and can be used in other pathmappings</span>
</span></span><span style=display:flex><span>          pathTemplateName <span style=color:#f92672>=</span> serviceName<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#34;-&#34;</span>, <span style=color:#e6db74>&#34;&#34;</span>) <span style=color:#f92672>+</span> yamlsBasePath
</span></span><span style=display:flex><span>          tplPathData <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#39;PathTemplateName&#39;</span>: pathTemplateName}
</span></span><span style=display:flex><span>          pathMappings<span style=color:#f92672>.</span>append({<span style=color:#e6db74>&#39;type&#39;</span>: <span style=color:#e6db74>&#39;PathTemplate&#39;</span>, \
</span></span><span style=display:flex><span>                              <span style=color:#e6db74>&#39;sourcePath&#39;</span>: <span style=color:#e6db74>&#34;{{ OutputRel </span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>+</span> yamlsPath <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74> }}&#34;</span>, \
</span></span><span style=display:flex><span>                              <span style=color:#e6db74>&#39;templateConfig&#39;</span>: tplPathData})
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>for</span> f <span style=color:#f92672>in</span> fileList:
</span></span><span style=display:flex><span>              filePath <span style=color:#f92672>=</span> fs<span style=color:#f92672>.</span>pathjoin(yamlsPath, f)
</span></span><span style=display:flex><span>              s <span style=color:#f92672>=</span> fs<span style=color:#f92672>.</span>read(filePath)
</span></span><span style=display:flex><span>              yamlData <span style=color:#f92672>=</span> yaml<span style=color:#f92672>.</span>loads(s)
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>if</span> yamlData[<span style=color:#e6db74>&#39;kind&#39;</span>] <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#39;Ingress&#39;</span>:
</span></span><span style=display:flex><span>                  <span style=color:#66d9ef>continue</span>
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>if</span> <span style=color:#e6db74>&#39;annotations&#39;</span> <span style=color:#f92672>not</span> <span style=color:#f92672>in</span> yamlData[<span style=color:#e6db74>&#39;metadata&#39;</span>]:
</span></span><span style=display:flex><span>                  yamlData[<span style=color:#e6db74>&#39;metadata&#39;</span>][<span style=color:#e6db74>&#39;annotations&#39;</span>] <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#39;kubernetes.io/ingress.class&#39;</span>: <span style=color:#e6db74>&#39;haproxy&#39;</span>}
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>                  yamlData[<span style=color:#e6db74>&#39;metadata&#39;</span>][<span style=color:#e6db74>&#39;annotations&#39;</span>][<span style=color:#e6db74>&#39;kubernetes.io/ingress.class&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;haproxy&#39;</span>
</span></span><span style=display:flex><span>              s <span style=color:#f92672>=</span> yaml<span style=color:#f92672>.</span>dumps(yamlData)
</span></span><span style=display:flex><span>              fs<span style=color:#f92672>.</span>write(filePath, s)
</span></span><span style=display:flex><span>              pathMappings<span style=color:#f92672>.</span>append({<span style=color:#e6db74>&#39;type&#39;</span>: <span style=color:#e6db74>&#39;Default&#39;</span>, \
</span></span><span style=display:flex><span>                      <span style=color:#e6db74>&#39;sourcePath&#39;</span>: yamlsPath, \
</span></span><span style=display:flex><span>                      <span style=color:#e6db74>&#39;destinationPath&#39;</span>: <span style=color:#e6db74>&#34;{{ .&#34;</span> <span style=color:#f92672>+</span> pathTemplateName <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34; }}&#34;</span>})
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> {<span style=color:#e6db74>&#39;pathMappings&#39;</span>: pathMappings, <span style=color:#e6db74>&#39;artifacts&#39;</span>: artifacts}{<span style=color:#f92672>%</span> endraw <span style=color:#f92672>%</span>}
</span></span></code></pre></div><p>This tutorial can be replicated in the UI by uploading the zip file of the custom transformer as a <code>customization</code>. Obtain the zip of the source and customization by adding a <code>-z</code> to the end of the commands used in steps 2 and 4.</p><p>The next step is parameterizing custom fields in Helm Chart, Kustomize, and OC Templates.</p><p><a href=https://github.com/konveyor/konveyor.github.io/blob/main/content/Move2Kube/Tutorials/CustomizeOutput/customAnnotationsYAML.md>Source</a></p><footer class=footline></footer></div></div><div id=navigation></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/js/clipboard.min.js></script><script src=/js/perfect-scrollbar.min.js></script><script src=/js/perfect-scrollbar.jquery.min.js></script><script src=/js/jquery.sticky.js></script><script src=/js/featherlight.min.js></script><script src=/js/highlight.pack.js></script><script>hljs.initHighlightingOnLoad()</script><script src=/js/modernizr.custom-3.6.0.js></script><script src=/js/learn.js></script><script src=/js/hugo-learn.js></script><script src=https://unpkg.com/mermaid@8.8.0/dist/mermaid.min.js></script><script>mermaid.initialize({startOnLoad:!0})</script><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TKPDMS3" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript></body></html>