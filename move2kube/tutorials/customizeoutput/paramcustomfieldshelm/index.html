<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.107.0"><meta name=description content><link rel=icon href=/images/favicon.png type=image/png><title>Parameterizing custom fields in Helm Chart, Kustomize, OC templates - Documentation for Konveyor projects</title><link href=/css/nucleus.css rel=stylesheet><link href=/css/fontawesome-all.min.css rel=stylesheet><link href=/css/hybrid.css rel=stylesheet><link href=/css/featherlight.min.css rel=stylesheet><link href=/css/perfect-scrollbar.min.css rel=stylesheet><link href=/css/auto-complete.css rel=stylesheet><link href=/css/atom-one-dark-reasonable.css rel=stylesheet><link href=/css/theme.css rel=stylesheet><link href=/css/tabs.css rel=stylesheet><link href=/css/hugo-theme.css rel=stylesheet><link href=/css/theme-konveyor.css rel=stylesheet><link href=/css/foo.css rel=stylesheet><link href=/css/bar.css rel=stylesheet><script src=/js/jquery-3.3.1.min.js></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style><script>var dataLayer=window.dataLayer=window.dataLayer||[];dataLayer.push({page:"Parameterizing custom fields in Helm Chart, Kustomize, OC templates",fileUniqID:"54375d84c84a63e216976584080b9727"})</script><script>(function(e,t,n,s,o){e[s]=e[s]||[],e[s].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var a=t.getElementsByTagName(n)[0],i=t.createElement(n),r=s!="dataLayer"?"&l="+s:"";i.async=!0,i.src="https://www.googletagmanager.com/gtm.js?id="+o+r,a.parentNode.insertBefore(i,a)})(window,document,"script","dataLayer","GTM-TKPDMS3")</script></head><body data-url=/move2kube/tutorials/customizeoutput/paramcustomfieldshelm/><nav id=sidebar><div id=header-wrapper><div id=header><a id=logo href=/><img src=/images/konveyor_logo.png></img></a>
<a href=https://github.com/konveyor/konveyor.github.io>Documentation source code</a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=/js/lunr.min.js></script>
<script type=text/javascript src=/js/auto-complete.js></script>
<script type=text/javascript>var baseurl="http://konveyor.github.io/"</script><script type=text/javascript src=/js/search.js></script></div><div class=highlightable><ul class=topics><li data-nav-id=/crane/ title=Crane class=dd-item><a href=/crane/><b>1 </b>Crane</a><ul><li data-nav-id=/crane/overview/ title=Overview class=dd-item><a href=/crane/overview/>Overview</a></li><li data-nav-id=/crane/tutorials/ title=Tutorials class=dd-item><a href=/crane/tutorials/>Tutorials</a><ul><li data-nav-id=/crane/tutorials/statelessappmirror/ title="Stateless application mirror" class=dd-item><a href=/crane/tutorials/statelessappmirror/>Stateless application mirror</a></li><li data-nav-id=/crane/tutorials/migratek8cluster/ title="Migrating a Kubernetes cluster" class=dd-item><a href=/crane/tutorials/migratek8cluster/>Migrating a Kubernetes cluster</a></li></ul></li><li data-nav-id=/crane/tools/ title=Tools class=dd-item><a href=/crane/tools/>Tools</a><ul><li data-nav-id=/crane/tools/gitopsintegration/ title="Integrating GitOps" class=dd-item><a href=/crane/tools/gitopsintegration/>Integrating GitOps</a></li><li data-nav-id=/crane/tools/customplugins/ title="Developing custom plugins" class=dd-item><a href=/crane/tools/customplugins/>Developing custom plugins</a></li><li data-nav-id=/crane/tools/tunnelapi/ title="Tunnel API" class=dd-item><a href=/crane/tools/tunnelapi/>Tunnel API</a></li><li data-nav-id=/crane/tools/pluginmanager/ title="Plugin Manager" class=dd-item><a href=/crane/tools/pluginmanager/>Plugin Manager</a></li></ul></li><li data-nav-id=/crane/usingcrane/ title="Using Crane" class=dd-item><a href=/crane/usingcrane/>Using Crane</a><ul><li data-nav-id=/crane/usingcrane/step1export/ title="Step One: Export Resources" class=dd-item><a href=/crane/usingcrane/step1export/>Step One: Export Resources</a></li><li data-nav-id=/crane/usingcrane/step2transform/ title="Step Two: Transform Exports" class=dd-item><a href=/crane/usingcrane/step2transform/>Step Two: Transform Exports</a></li><li data-nav-id=/crane/usingcrane/step3apply/ title="Step Three: Apply Patches" class=dd-item><a href=/crane/usingcrane/step3apply/>Step Three: Apply Patches</a></li></ul></li><li data-nav-id=/crane/installation/ title="Installing Crane" class=dd-item><a href=/crane/installation/>Installing Crane</a></li></ul></li><li data-nav-id=/forklift/ title=Forklift class=dd-item><a href=/forklift/><b>2 </b>Forklift</a><ul><li data-nav-id=/forklift/overview/ title=Overview class=dd-item><a href=/forklift/overview/>Overview</a></li><li data-nav-id=/forklift/migratingvms/ title="Migrating virtual machines" class=dd-item><a href=/forklift/migratingvms/>Migrating virtual machines</a><ul><li data-nav-id=/forklift/migratingvms/migrateoptions/ title="Migration plan options" class=dd-item><a href=/forklift/migratingvms/migrateoptions/>Migration plan options</a></li><li data-nav-id=/forklift/migratingvms/migratecli/ title="Migrating virtual machines using the command line" class=dd-item><a href=/forklift/migratingvms/migratecli/>Migrating virtual machines using the command line</a></li><li data-nav-id=/forklift/migratingvms/migrateweb/ title="Migrating virtual machines using the web console" class=dd-item><a href=/forklift/migratingvms/migrateweb/>Migrating virtual machines using the web console</a></li><li data-nav-id=/forklift/migratingvms/cancelmigrate/ title="Canceling a migration" class=dd-item><a href=/forklift/migratingvms/cancelmigrate/>Canceling a migration</a></li><li data-nav-id=/forklift/migratingvms/advancedmigrate/ title="Advanced migration options" class=dd-item><a href=/forklift/migratingvms/advancedmigrate/>Advanced migration options</a></li></ul></li><li data-nav-id=/forklift/installingforklift/ title="Installing Forklift" class=dd-item><a href=/forklift/installingforklift/>Installing Forklift</a><ul><li data-nav-id=/forklift/installingforklift/upgrade/ title="Upgrading Forklift" class=dd-item><a href=/forklift/installingforklift/upgrade/>Upgrading Forklift</a></li><li data-nav-id=/forklift/installingforklift/uninstall/ title="Uninstalling Forklift" class=dd-item><a href=/forklift/installingforklift/uninstall/>Uninstalling Forklift</a></li><li data-nav-id=/forklift/installingforklift/installation/ title="Installing the Forklift Operator" class=dd-item><a href=/forklift/installingforklift/installation/>Installing the Forklift Operator</a></li><li data-nav-id=/forklift/installingforklift/prereqs/ title=Prerequisites class=dd-item><a href=/forklift/installingforklift/prereqs/>Prerequisites</a></li></ul></li></ul></li><li data-nav-id=/move2kube/ title=Move2Kube class="dd-item
parent"><a href=/move2kube/><b>3 </b>Move2Kube</a><ul><li data-nav-id=/move2kube/overview/ title=Overview class=dd-item><a href=/move2kube/overview/>Overview</a></li><li data-nav-id=/move2kube/concepts/ title=Concepts class=dd-item><a href=/move2kube/concepts/>Concepts</a></li><li data-nav-id=/move2kube/installation/ title=Installation class=dd-item><a href=/move2kube/installation/>Installation</a><ul><li data-nav-id=/move2kube/installation/installweb/ title="Web Interface" class=dd-item><a href=/move2kube/installation/installweb/>Web Interface</a></li><li data-nav-id=/move2kube/installation/installcli/ title="Command line tool" class=dd-item><a href=/move2kube/installation/installcli/>Command line tool</a></li></ul></li><li data-nav-id=/move2kube/commands/ title=Commands class=dd-item><a href=/move2kube/commands/>Commands</a></li><li data-nav-id=/move2kube/transformers/ title=Transformers class=dd-item><a href=/move2kube/transformers/>Transformers</a></li><li data-nav-id=/move2kube/tutorials/ title=Tutorials class="dd-item
parent"><a href=/move2kube/tutorials/>Tutorials</a><ul><li data-nav-id=/move2kube/tutorials/usingcli/ title="Using Move2Kube CLI" class=dd-item><a href=/move2kube/tutorials/usingcli/>Using Move2Kube CLI</a></li><li data-nav-id=/move2kube/tutorials/usingui/ title="Using Move2Kube UI" class=dd-item><a href=/move2kube/tutorials/usingui/>Using Move2Kube UI</a></li><li data-nav-id=/move2kube/tutorials/cfappstok8/ title="Migrating Enterprise Scale Cloud Foundry Apps to Kubernetes" class=dd-item><a href=/move2kube/tutorials/cfappstok8/>Migrating Enterprise Scale Cloud Foundry Apps to Kubernetes</a><ul><li data-nav-id=/move2kube/tutorials/cfappstok8/1collect/ title="1. Collect" class=dd-item><a href=/move2kube/tutorials/cfappstok8/1collect/>1. Collect</a></li><li data-nav-id=/move2kube/tutorials/cfappstok8/2plan/ title="2. Plan" class=dd-item><a href=/move2kube/tutorials/cfappstok8/2plan/>2. Plan</a></li><li data-nav-id=/move2kube/tutorials/cfappstok8/3transform/ title="3. Transform" class=dd-item><a href=/move2kube/tutorials/cfappstok8/3transform/>3. Transform</a></li></ul></li><li data-nav-id=/move2kube/tutorials/customizeoutput/ title="Customizing the output" class="dd-item
parent"><a href=/move2kube/tutorials/customizeoutput/>Customizing the output</a><ul><li data-nav-id=/move2kube/tutorials/customizeoutput/addcustfiledir/ title="Add custom files and directories in custom locations" class=dd-item><a href=/move2kube/tutorials/customizeoutput/addcustfiledir/>Add custom files and directories in custom locations</a></li><li data-nav-id=/move2kube/tutorials/customizeoutput/paramcustomfieldshelm/ title="Parameterizing custom fields in Helm Chart, Kustomize, OC templates" class="dd-item active"><a href=/move2kube/tutorials/customizeoutput/paramcustomfieldshelm/>Parameterizing custom fields in Helm Chart, Kustomize, OC templates</a></li><li data-nav-id=/move2kube/tutorials/customizeoutput/customannotationsyaml/ title="Add custom annotations to Kubernetes YAMLs" class=dd-item><a href=/move2kube/tutorials/customizeoutput/customannotationsyaml/>Add custom annotations to Kubernetes YAMLs</a></li><li data-nav-id=/move2kube/tutorials/customizeoutput/customgendockerfile/ title="Customize generated Dockerfile and built-in transformer behavior" class=dd-item><a href=/move2kube/tutorials/customizeoutput/customgendockerfile/>Customize generated Dockerfile and built-in transformer behavior</a></li></ul></li><li data-nav-id=/move2kube/tutorials/customkubeyaml/ title="Customize Kubernetes YAMLs to target specific clusters" class=dd-item><a href=/move2kube/tutorials/customkubeyaml/>Customize Kubernetes YAMLs to target specific clusters</a></li><li data-nav-id=/move2kube/tutorials/createhelmchartskustomize/ title="Create Helm-charts, Kustomize overlays from Kubernetes Yamls" class=dd-item><a href=/move2kube/tutorials/createhelmchartskustomize/>Create Helm-charts, Kustomize overlays from Kubernetes Yamls</a></li><li data-nav-id=/move2kube/tutorials/createwincontainersnet/ title="Create and deploy Windows .NET containers" class=dd-item><a href=/move2kube/tutorials/createwincontainersnet/>Create and deploy Windows .NET containers</a></li><li data-nav-id=/move2kube/tutorials/migratedeploynetcore/ title="Migrate and deploy .NET Core applications to Kubernetes" class=dd-item><a href=/move2kube/tutorials/migratedeploynetcore/>Migrate and deploy .NET Core applications to Kubernetes</a></li><li data-nav-id=/move2kube/tutorials/migratedockercomposekube/ title="Migrate from Docker Compose to Kubernetes" class=dd-item><a href=/move2kube/tutorials/migratedockercomposekube/>Migrate from Docker Compose to Kubernetes</a></li><li data-nav-id=/move2kube/tutorials/migratedeploycfapps/ title="Migrate and deploy Cloud Foundry applications to Kubernetes" class=dd-item><a href=/move2kube/tutorials/migratedeploycfapps/>Migrate and deploy Cloud Foundry applications to Kubernetes</a></li><li data-nav-id=/move2kube/tutorials/runnoninteractively/ title="Run transforms non-interactively" class=dd-item><a href=/move2kube/tutorials/runnoninteractively/>Run transforms non-interactively</a></li></ul></li></ul></li><li data-nav-id=/tackle/ title=Tackle class=dd-item><a href=/tackle/><b>4 </b>Tackle</a><ul><li data-nav-id=/tackle/overview/ title=Overview class=dd-item><a href=/tackle/overview/>Overview</a></li><li data-nav-id=/tackle/upgradeto2/ title="Upgrading to 2.0" class=dd-item><a href=/tackle/upgradeto2/>Upgrading to 2.0</a></li><li data-nav-id=/tackle/admintasks/ title="Administrator view tasks" class=dd-item><a href=/tackle/admintasks/>Administrator view tasks</a></li><li data-nav-id=/tackle/views/ title=Views class=dd-item><a href=/tackle/views/>Views</a></li><li data-nav-id=/tackle/instances/ title="Seeding Instances" class=dd-item><a href=/tackle/instances/>Seeding Instances</a></li><li data-nav-id=/tackle/installation/ title="Installing Tackle" class=dd-item><a href=/tackle/installation/>Installing Tackle</a></li><li data-nav-id=/tackle/assessanalyze/ title="Assessing and analyzing applications" class=dd-item><a href=/tackle/assessanalyze/>Assessing and analyzing applications</a></li><li data-nav-id=/tackle/addapps/ title="Adding applications" class=dd-item><a href=/tackle/addapps/>Adding applications</a></li></ul></li></ul><section id=footer><p>Built with <a href=https://github.com/matcornic/hugo-theme-learn><i class="fas fa-heart"></i></a> from <a href=https://getgrav.org>Grav</a> and <a href=https://gohugo.io/>Hugo</a></p></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span>
<span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links>Parameterizing custom fields in Helm Chart, Kustomize, OC templates</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#anatomy-of-the-parameterizer>Anatomy of the parameterizer</a></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Parameterizing custom fields in Helm Chart, Kustomize, OC templates</h1><p>In this tutorial, we illustrate how to parameterize a custom field in the Helm chart generated by Move2Kube.</p><ol><li>Start by creating an empty workspace directory say <code>workspace</code> and make it the current working directory. We will assume all commands are executed within this directory.</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>$ mkdir workspace <span style=color:#f92672>&amp;&amp;</span> cd workspace
</span></span></code></pre></div><ol start=2><li>Use the <a href=https://github.com/konveyor/move2kube-demos/tree/main/samples/enterprise-app>enterprise-app</a> as input for this flow.</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>$ curl https://move2kube.konveyor.io/scripts/download.sh | bash -s -- -d samples/enterprise-app/src -r move2kube-demos
</span></span><span style=display:flex><span>$ ls src
</span></span><span style=display:flex><span>README.md		config-utils		customers	docs			frontend		gateway			orders
</span></span></code></pre></div><ol start=3><li>Run Move2Kube <strong>without</strong> any customization. The relevant snippet from the deployment YAML generated in the path <code>myproject/deploy/yamls-parameterized/helm-chart/myproject/templates/orders-deployment.yaml</code> looks like this.</li></ol><p>When complete, delete the <code>myproject</code> directory.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>$ move2kube transform -s src/ --qa-skip <span style=color:#f92672>&amp;&amp;</span> cat myproject/deploy/yamls-parameterized/helm-chart/myproject/templates/orders-deployment.yaml <span style=color:#f92672>&amp;&amp;</span> rm -rf myproject
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>  <span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>apps/v1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Deployment</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>annotations</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>move2kube.konveyor.io/service.expose</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>creationTimestamp</span>: <span style=color:#66d9ef>null</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>move2kube.konveyor.io/service</span>: <span style=color:#ae81ff>orders</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>name</span>: <span style=color:#ae81ff>orders</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>progressDeadlineSeconds</span>: <span style=color:#ae81ff>600</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>replicas</span>: {<span style=color:#ae81ff>% raw %}{{ index .Values &#34;common&#34; &#34;replicas&#34; }}{% endraw %}</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>revisionHistoryLimit</span>: <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>selector</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>matchLabels</span>:
</span></span><span style=display:flex><span>              <span style=color:#f92672>move2kube.konveyor.io/service</span>: <span style=color:#ae81ff>orders</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>strategy</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>rollingUpdate</span>:
</span></span><span style=display:flex><span>              <span style=color:#f92672>maxSurge</span>: <span style=color:#ae81ff>25</span><span style=color:#ae81ff>%</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>maxUnavailable</span>: <span style=color:#ae81ff>25</span><span style=color:#ae81ff>%</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>type</span>: <span style=color:#ae81ff>RollingUpdate</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>template</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>              <span style=color:#f92672>annotations</span>:
</span></span><span style=display:flex><span>                  <span style=color:#f92672>move2kube.konveyor.io/service.expose</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>creationTimestamp</span>: <span style=color:#66d9ef>null</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>                  <span style=color:#f92672>move2kube.konveyor.io/service</span>: <span style=color:#ae81ff>orders</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>name</span>: <span style=color:#ae81ff>orders</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>              <span style=color:#f92672>containers</span>:
</span></span><span style=display:flex><span>                  - <span style=color:#f92672>env</span>:
</span></span><span style=display:flex><span>                      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>PORT</span>
</span></span><span style=display:flex><span>                        <span style=color:#f92672>value</span>: <span style=color:#e6db74>&#34;8080&#34;</span>
</span></span><span style=display:flex><span>                    <span style=color:#f92672>image</span>: <span style=color:#ae81ff>quay.io/myproject/orders:latest</span>
</span></span><span style=display:flex><span>                    <span style=color:#f92672>imagePullPolicy</span>: <span style=color:#ae81ff>Always</span>
</span></span><span style=display:flex><span>                    <span style=color:#f92672>name</span>: <span style=color:#ae81ff>orders</span>
</span></span><span style=display:flex><span>                    <span style=color:#f92672>ports</span>:
</span></span><span style=display:flex><span>                      - <span style=color:#f92672>containerPort</span>: <span style=color:#ae81ff>8080</span>
</span></span><span style=display:flex><span>                        <span style=color:#f92672>protocol</span>: <span style=color:#ae81ff>TCP</span>
</span></span><span style=display:flex><span>                    <span style=color:#f92672>resources</span>: {}
</span></span><span style=display:flex><span>                    <span style=color:#f92672>terminationMessagePath</span>: <span style=color:#ae81ff>/dev/termination-log</span>
</span></span><span style=display:flex><span>                    <span style=color:#f92672>terminationMessagePolicy</span>: <span style=color:#ae81ff>File</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>dnsPolicy</span>: <span style=color:#ae81ff>ClusterFirst</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>imagePullSecrets</span>:
</span></span><span style=display:flex><span>                  - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>quay-io-imagepullsecret</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>restartPolicy</span>: <span style=color:#ae81ff>Always</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>schedulerName</span>: <span style=color:#ae81ff>default-scheduler</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>securityContext</span>: {}
</span></span><span style=display:flex><span>              <span style=color:#f92672>terminationGracePeriodSeconds</span>: <span style=color:#ae81ff>30</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>status</span>: {}
</span></span></code></pre></div><p>Notice that except the replicas field, no other field is parameterized.</p><ol start=4><li>Use a <a href=https://github.com/konveyor/move2kube-transformers/tree/main/custom-helm-kustomize-octemplates-parameterization>custom configured version</a> of the <a href=https://github.com/konveyor/move2kube/tree/main/assets/built-in/transformers/kubernetes/parameterizer>parameterizer transformer</a> to view the parameterizing the other fields in the transformer.</li></ol><p>Then copy <a href=https://github.com/konveyor/move2kube-transformers/tree/main/custom-helm-kustomize-octemplates-parameterization>it</a> into the <code>customizations</code> sub-directory.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>$ curl https://move2kube.konveyor.io/scripts/download.sh | bash -s -- -d custom-helm-kustomize-octemplates-parameterization -r move2kube-transformers -o customizations
</span></span></code></pre></div><ol start=5><li>Transform using this customization and specify the customization using the <code>-c</code> flag.</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>$ move2kube transform -s src/ -c customizations/ --qa-skip
</span></span></code></pre></div><p>When the output is generated, observe the same deployment as mentioned before.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>$ cat myproject/deploy/yamls-parameterized/helm-chart/myproject/templates/orders-deployment.yaml
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>  {<span style=color:#f92672>% raw %}apiVersion</span>: <span style=color:#ae81ff>apps/v1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Deployment</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>annotations</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>move2kube.konveyor.io/service.expose</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>creationTimestamp</span>: <span style=color:#66d9ef>null</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>move2kube.konveyor.io/service</span>: <span style=color:#ae81ff>orders</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>name</span>: <span style=color:#ae81ff>orders</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>progressDeadlineSeconds</span>: <span style=color:#ae81ff>600</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>replicas</span>: {{ <span style=color:#ae81ff>index .Values &#34;common&#34; &#34;replicas&#34; }}</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>revisionHistoryLimit</span>: <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>selector</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>matchLabels</span>:
</span></span><span style=display:flex><span>              <span style=color:#f92672>move2kube.konveyor.io/service</span>: <span style=color:#ae81ff>orders</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>strategy</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>rollingUpdate</span>:
</span></span><span style=display:flex><span>              <span style=color:#f92672>maxSurge</span>: <span style=color:#ae81ff>25</span><span style=color:#ae81ff>%</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>maxUnavailable</span>: <span style=color:#ae81ff>25</span><span style=color:#ae81ff>%</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>type</span>: <span style=color:#ae81ff>RollingUpdate</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>template</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>              <span style=color:#f92672>annotations</span>:
</span></span><span style=display:flex><span>                  <span style=color:#f92672>move2kube.konveyor.io/service.expose</span>: <span style=color:#e6db74>&#34;true&#34;</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>creationTimestamp</span>: <span style=color:#66d9ef>null</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>labels</span>:
</span></span><span style=display:flex><span>                  <span style=color:#f92672>move2kube.konveyor.io/service</span>: <span style=color:#ae81ff>orders</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>name</span>: <span style=color:#ae81ff>orders</span>
</span></span><span style=display:flex><span>          <span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>              <span style=color:#f92672>containers</span>:
</span></span><span style=display:flex><span>                  - <span style=color:#f92672>env</span>:
</span></span><span style=display:flex><span>                      - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>PORT</span>
</span></span><span style=display:flex><span>                        <span style=color:#f92672>value</span>: <span style=color:#e6db74>&#34;8080&#34;</span>
</span></span><span style=display:flex><span>                    <span style=color:#f92672>image</span>: {{ <span style=color:#ae81ff>index .Values &#34;imageregistry&#34; &#34;url&#34; }}/{{ index .Values &#34;imageregistry&#34; &#34;namespace&#34; }}/{{ index .Values &#34;services&#34; &#34;orders&#34; &#34;containers&#34; &#34;orders&#34; &#34;image&#34; &#34;name&#34; }}:{{ index .Values &#34;services&#34; &#34;orders&#34; &#34;containers&#34; &#34;orders&#34; &#34;image&#34; &#34;tag&#34; }}</span>
</span></span><span style=display:flex><span>                    <span style=color:#f92672>imagePullPolicy</span>: <span style=color:#ae81ff>Always</span>
</span></span><span style=display:flex><span>                    <span style=color:#f92672>name</span>: <span style=color:#ae81ff>orders</span>
</span></span><span style=display:flex><span>                    <span style=color:#f92672>ports</span>:
</span></span><span style=display:flex><span>                      - <span style=color:#f92672>containerPort</span>: <span style=color:#ae81ff>8080</span>
</span></span><span style=display:flex><span>                        <span style=color:#f92672>protocol</span>: <span style=color:#ae81ff>TCP</span>
</span></span><span style=display:flex><span>                    <span style=color:#f92672>resources</span>: {}
</span></span><span style=display:flex><span>                    <span style=color:#f92672>terminationMessagePath</span>: <span style=color:#ae81ff>/dev/termination-log</span>
</span></span><span style=display:flex><span>                    <span style=color:#f92672>terminationMessagePolicy</span>: <span style=color:#ae81ff>File</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>dnsPolicy</span>: <span style=color:#ae81ff>ClusterFirst</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>imagePullSecrets</span>:
</span></span><span style=display:flex><span>                  - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>quay-io-imagepullsecret</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>restartPolicy</span>: <span style=color:#ae81ff>Always</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>schedulerName</span>: <span style=color:#ae81ff>default-scheduler</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>securityContext</span>: {}
</span></span><span style=display:flex><span>              <span style=color:#f92672>terminationGracePeriodSeconds</span>: <span style=color:#ae81ff>30</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>status</span>: {}
</span></span><span style=display:flex><span>  {<span style=color:#ae81ff>% endraw %}</span>
</span></span></code></pre></div><p>A few of the parameterized yamls are:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>$ cat myproject/deploy/yamls-parameterized/helm-chart/myproject/values-prod.yaml
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>  <span style=color:#f92672>common</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>replicas</span>: <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>imageregistry</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>konveyor</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>url</span>: <span style=color:#ae81ff>quay.io</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>services</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>config-utils</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>containers</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>config-utils</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>image</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>name</span>: <span style=color:#ae81ff>myimage</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>tag</span>: <span style=color:#ae81ff>latest</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>customers</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>containers</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>customers</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>image</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>name</span>: <span style=color:#ae81ff>myimage</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>tag</span>: <span style=color:#ae81ff>latest</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>frontend</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>containers</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>frontend</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>image</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>name</span>: <span style=color:#ae81ff>frontend</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>tag</span>: <span style=color:#ae81ff>latest</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>gateway</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>containers</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>gateway</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>image</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>name</span>: <span style=color:#ae81ff>myimage</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>tag</span>: <span style=color:#ae81ff>latest</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>orders</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>containers</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>orders</span>:
</span></span><span style=display:flex><span>          <span style=color:#f92672>image</span>:
</span></span><span style=display:flex><span>            <span style=color:#f92672>name</span>: <span style=color:#ae81ff>orders</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>tag</span>: <span style=color:#ae81ff>latest</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>$ cat myproject/deploy/yamls-parameterized/kustomize/overlays/prod/apps-v1-deployment-orders.yaml
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>  - <span style=color:#f92672>op</span>: <span style=color:#ae81ff>replace</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>path</span>: <span style=color:#ae81ff>/spec/replicas</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>value</span>: <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>  - <span style=color:#f92672>op</span>: <span style=color:#ae81ff>replace</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>path</span>: <span style=color:#ae81ff>/spec/template/spec/containers/0/image</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>value</span>: <span style=color:#ae81ff>orders</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>$ cat myproject/deploy/yamls-parameterized/openshift-template/parameters-prod.yaml
</span></span></code></pre></div><pre tabindex=0><code>COMMON_REPLICAS=10
IMAGEREGISTRY_URL=quay.io
IMAGEREGISTRY_NAMESPACE=konveyor
SERVICES_FRONTEND_CONTAINERS_FRONTEND_IMAGE_TAG=latest
SERVICES_GATEWAY_CONTAINERS_GATEWAY_IMAGE_NAME=myimage
SERVICES_ORDERS_CONTAINERS_ORDERS_IMAGE_NAME=orders
SERVICES_ORDERS_CONTAINERS_ORDERS_IMAGE_TAG=latest
SERVICES_CUSTOMERS_TOMCAT_CONTAINERS_CUSTOMERS_TOMCAT_IMAGE_NAME=myimage
SERVICES_CUSTOMERS_TOMCAT_CONTAINERS_CUSTOMERS_TOMCAT_IMAGE_TAG=latest
SERVICES_FRONTEND_CONTAINERS_FRONTEND_IMAGE_NAME=frontend
SERVICES_CONFIG_UTILS_CONTAINERS_CONFIG_UTILS_IMAGE_NAME=myimage
SERVICES_CONFIG_UTILS_CONTAINERS_CONFIG_UTILS_IMAGE_TAG=latest
SERVICES_GATEWAY_CONTAINERS_GATEWAY_IMAGE_TAG=latest
</code></pre><h2 id=anatomy-of-the-parameterizer>Anatomy of the parameterizer</h2><p>The contents of parameterizer are as shown below:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>$ ls customizations/custom-helm-kustomize-octemplates-parameterization/
</span></span><span style=display:flex><span>README.md			deployment-parameterizers.yaml	parameterizers.yaml
</span></span></code></pre></div><p>The transformer configuration is in <code>parameterizers.yaml</code> and the parameterization config is in <code>deployment-parameterizers.yaml</code>. The configuration below specifies the fields that need to be parameterized, how to parameterize them, and the default values those fields should take. This can be extended to parameterize any field in any Kubernetes Yaml, and generate the appropriate helm chart, Kustomize YAMLs and Openshift templates.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span>$ cat customizations/custom-helm-kustomize-octemplates-parameterization/deployment-parameterizers.yaml
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>  {<span style=color:#f92672>% raw %}apiVersion</span>: <span style=color:#ae81ff>move2kube.konveyor.io/v1alpha1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Parameterizer</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>: <span style=color:#ae81ff>deployment-parameterizers</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>parameterizers</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>target</span>: <span style=color:#e6db74>&#34;spec.replicas&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>template</span>: <span style=color:#e6db74>&#34;${common.replicas}&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>default</span>: <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>filters</span>:
</span></span><span style=display:flex><span>          - <span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Deployment</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>apiVersion</span>: <span style=color:#e6db74>&#34;.*/v1.*&#34;</span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>target</span>: <span style=color:#e6db74>&#39;spec.template.spec.containers.[containerName:name].image&#39;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>template</span>: <span style=color:#e6db74>&#39;${imageregistry.url}/${imageregistry.namespace}/${services.$(metadataName).containers.$(containerName).image.name}:${services.$(metadataName).containers.$(containerName).image.tag}&#39;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>default</span>: <span style=color:#ae81ff>quay.io/konveyor/myimage:latest</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>filters</span>:
</span></span><span style=display:flex><span>          - <span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Deployment</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>apiVersion</span>: <span style=color:#e6db74>&#34;.*/v1.*&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>parameters</span>:
</span></span><span style=display:flex><span>          - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>services.$(metadataName).containers.$(containerName).image.name</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>values</span>:
</span></span><span style=display:flex><span>            - <span style=color:#f92672>envs</span>: [<span style=color:#ae81ff>dev, staging, prod]</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>metadataName</span>: <span style=color:#ae81ff>frontend</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>value</span>: <span style=color:#ae81ff>frontend</span>
</span></span><span style=display:flex><span>            - <span style=color:#f92672>envs</span>: [<span style=color:#ae81ff>prod]</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>metadataName</span>: <span style=color:#ae81ff>orders</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>value</span>: <span style=color:#ae81ff>orders</span>
</span></span><span style=display:flex><span>              <span style=color:#f92672>custom</span>:
</span></span><span style=display:flex><span>                <span style=color:#f92672>containerName</span>: <span style=color:#ae81ff>orders</span>
</span></span><span style=display:flex><span>  {<span style=color:#ae81ff>% endraw %}</span>
</span></span></code></pre></div><p>Next step is adding custom files and directories in custom locations.</p><footer class=footline></footer></div></div><div id=navigation></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/js/clipboard.min.js></script>
<script src=/js/perfect-scrollbar.min.js></script>
<script src=/js/perfect-scrollbar.jquery.min.js></script>
<script src=/js/jquery.sticky.js></script>
<script src=/js/featherlight.min.js></script>
<script src=/js/highlight.pack.js></script>
<script>hljs.initHighlightingOnLoad()</script><script src=/js/modernizr.custom-3.6.0.js></script>
<script src=/js/learn.js></script>
<script src=/js/hugo-learn.js></script>
<script src=https://unpkg.com/mermaid@8.8.0/dist/mermaid.min.js></script>
<script>mermaid.initialize({startOnLoad:!0})</script><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TKPDMS3" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript></body></html>